steps:
  - script: |
      yarn workspace @ckb-lumos/config-manager build
      yarn workspace @ckb-lumos/helpers build
      yarn workspace @ckb-lumos/rpc build
      yarn workspace @ckb-lumos/testkit build
      yarn workspace @ckb-lumos/common-scripts build
      yarn workspace @ckb-lumos/hd build
      yarn workspace @ckb-lumos/hd-cache build
      yarn workspace @ckb-lumos/ckb-indexer build
      yarn workspace @ckb-lumos/lumos build
      yarn c8 --reporter=cobertura --reporter=html yarn run test --ignore "**/*/*sql-indexer*"
      yarn workspaces run fmt
      yarn workspaces run lint
      git diff --exit-code
    displayName: "Generic tests"
