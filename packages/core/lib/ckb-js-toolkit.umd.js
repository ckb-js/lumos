!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).CKBJSToolkit={})}(this,(function(t){"use strict";class e{constructor(t){this.view=new DataView(t)}length(){return this.view.byteLength}indexAt(t){return this.view.getUint8(t)}toArrayBuffer(){return this.view.buffer}serializeJson(){return"0x"+Array.prototype.map.call(new Uint8Array(this.view.buffer),(t=>("00"+t.toString(16)).slice(-2))).join("")}}class r{constructor(t){this.string=t}length(){return this.string.length/2-1}indexAt(t){return parseInt(this.string.substr(2+2*t,2),16)}toArrayBuffer(){const t=new ArrayBuffer(this.length()),e=new DataView(t);for(let t=0;t<this.length();t++)e.setUint8(t,this.indexAt(t));return t}serializeJson(){return this.string}}class n{constructor(t){if(t instanceof r||t instanceof e)return t;if("string"==typeof t){if(!t.startsWith("0x")||t.length%2!=0)throw new Error("Hex string must start with 0x, and has even numbered length!");return new r(t)}if(t instanceof ArrayBuffer)return new e(t);throw new Error("Reader can only accept hex string or ArrayBuffer!")}static fromRawString(t){const r=new ArrayBuffer(t.length),n=new DataView(r);for(let e=0;e<t.length;e++){const r=t.charCodeAt(e);if(r>255)throw new Error("fromRawString can only accept UTF-8 raw string!");n.setUint8(e,r)}return new e(r)}}var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function o(t,e,r){return t(r={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&r.path)}},r.exports),r.exports}var a=o((function(t,e){t.exports=function(){function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var r,n=0;n<e.length;n++)(r=e[n]).enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}function n(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}function o(t){return o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},o(t)}function a(t,e){return a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},a(t,e)}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function s(){return s=u()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var i=new(Function.bind.apply(t,n));return r&&a(i,r.prototype),i},s.apply(null,arguments)}function _(t){return-1!==Function.toString.call(t).indexOf("[native code]")}function l(t){var e="function"==typeof Map?new Map:void 0;return l=function(t){function r(){return s(t,arguments,o(this).constructor)}if(null===t||!_(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),a(r,t)},l(t)}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?f(t):e}function h(t){var e=u();return function(){var r,n=o(t);if(e){var i=o(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return c(this,r)}}function g(t,e){if(t){if("string"==typeof t)return d(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(t,e):void 0}}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function p(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=g(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw o}}}}var v=function(r){var o=Math.abs,a=Math.max,u=Math.imul,s=Math.clz32;function _(t,r){var n;if(e(this,_),t>_.__kMaxLength)throw new RangeError("Maximum BigInt size exceeded");return(n=l.call(this,t)).sign=r,n}i(_,r);var l=h(_);return n(_,[{key:"toDebugString",value:function(){var t,e=["BigInt["],r=p(this);try{for(r.s();!(t=r.n()).done;){var n=t.value;e.push((n?(n>>>0).toString(16):n)+", ")}}catch(t){r.e(t)}finally{r.f()}return e.push("]"),e.join("")}},{key:"toString",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:10;if(2>t||36<t)throw new RangeError("toString() radix argument must be between 2 and 36");return 0===this.length?"0":0==(t&t-1)?_.__toStringBasePowerOfTwo(this,t):_.__toStringGeneric(this,t,!1)}},{key:"__copy",value:function(){for(var t=new _(this.length,this.sign),e=0;e<this.length;e++)t[e]=this[e];return t}},{key:"__trim",value:function(){for(var t=this.length,e=this[t-1];0===e;)e=this[--t-1],this.pop();return 0===t&&(this.sign=!1),this}},{key:"__initializeDigits",value:function(){for(var t=0;t<this.length;t++)this[t]=0}},{key:"__clzmsd",value:function(){return s(this[this.length-1])}},{key:"__inplaceMultiplyAdd",value:function(t,e,r){r>this.length&&(r=this.length);for(var n=65535&t,i=t>>>16,o=0,a=65535&e,s=e>>>16,_=0;_<r;_++){var l=this.__digit(_),f=65535&l,c=l>>>16,h=u(f,n),g=u(f,i),d=u(c,n),p=u(c,i),v=a+(65535&h),y=s+o+(v>>>16)+(h>>>16)+(65535&g)+(65535&d);o=(a=(g>>>16)+(d>>>16)+(65535&p)+(y>>>16))>>>16,a&=65535,s=p>>>16,this.__setDigit(_,65535&v|y<<16)}if(0!==o||0!==a||0!==s)throw new Error("implementation bug")}},{key:"__inplaceAdd",value:function(t,e,r){for(var n,i=0,o=0;o<r;o++)i=(n=this.__halfDigit(e+o)+t.__halfDigit(o)+i)>>>16,this.__setHalfDigit(e+o,n);return i}},{key:"__inplaceSub",value:function(t,e,r){var n=0;if(1&e){e>>=1;for(var i=this.__digit(e),o=65535&i,a=0;a<r-1>>>1;a++){var u=t.__digit(a),s=(i>>>16)-(65535&u)-n;n=1&s>>>16,this.__setDigit(e+a,s<<16|65535&o),n=1&(o=(65535&(i=this.__digit(e+a+1)))-(u>>>16)-n)>>>16}var _=t.__digit(a),l=(i>>>16)-(65535&_)-n;if(n=1&l>>>16,this.__setDigit(e+a,l<<16|65535&o),e+a+1>=this.length)throw new RangeError("out of bounds");0==(1&r)&&(n=1&(o=(65535&(i=this.__digit(e+a+1)))-(_>>>16)-n)>>>16,this.__setDigit(e+t.length,4294901760&i|65535&o))}else{e>>=1;for(var f=0;f<t.length-1;f++){var c=this.__digit(e+f),h=t.__digit(f),g=(65535&c)-(65535&h)-n,d=(c>>>16)-(h>>>16)-(n=1&g>>>16);n=1&d>>>16,this.__setDigit(e+f,d<<16|65535&g)}var p=this.__digit(e+f),v=t.__digit(f),y=(65535&p)-(65535&v)-n;n=1&y>>>16;var b=0;0==(1&r)&&(n=1&(b=(p>>>16)-(v>>>16)-n)>>>16),this.__setDigit(e+f,b<<16|65535&y)}return n}},{key:"__inplaceRightShift",value:function(t){if(0!==t){for(var e,r=this.__digit(0)>>>t,n=this.length-1,i=0;i<n;i++)e=this.__digit(i+1),this.__setDigit(i,e<<32-t|r),r=e>>>t;this.__setDigit(n,r)}}},{key:"__digit",value:function(t){return this[t]}},{key:"__unsignedDigit",value:function(t){return this[t]>>>0}},{key:"__setDigit",value:function(t,e){this[t]=0|e}},{key:"__setDigitGrow",value:function(t,e){this[t]=0|e}},{key:"__halfDigitLength",value:function(){var t=this.length;return 65535>=this.__unsignedDigit(t-1)?2*t-1:2*t}},{key:"__halfDigit",value:function(t){return 65535&this[t>>>1]>>>((1&t)<<4)}},{key:"__setHalfDigit",value:function(t,e){var r=t>>>1,n=this.__digit(r),i=1&t?65535&n|e<<16:4294901760&n|65535&e;this.__setDigit(r,i)}}],[{key:"BigInt",value:function(e){var r=Math.floor,n=Number.isFinite;if("number"==typeof e){if(0===e)return _.__zero();if((0|e)===e)return 0>e?_.__oneDigit(-e,!0):_.__oneDigit(e,!1);if(!n(e)||r(e)!==e)throw new RangeError("The number "+e+" cannot be converted to BigInt because it is not an integer");return _.__fromDouble(e)}if("string"==typeof e){var i=_.__fromString(e);if(null===i)throw new SyntaxError("Cannot convert "+e+" to a BigInt");return i}if("boolean"==typeof e)return!0===e?_.__oneDigit(1,!1):_.__zero();if("object"===t(e)){if(e.constructor===_)return e;var o=_.__toPrimitive(e);return _.BigInt(o)}throw new TypeError("Cannot convert "+e+" to a BigInt")}},{key:"toNumber",value:function(t){var e=t.length;if(0===e)return 0;if(1===e){var r=t.__unsignedDigit(0);return t.sign?-r:r}var n=t.__digit(e-1),i=s(n),o=32*e-i;if(1024<o)return t.sign?-1/0:1/0;var a=o-1,u=n,l=e-1,f=i+1,c=32===f?0:u<<f;c>>>=12;var h=f-12,g=12<=f?0:u<<20+f,d=20+f;0<h&&0<l&&(l--,c|=(u=t.__digit(l))>>>32-h,g=u<<h,d=h),0<d&&0<l&&(l--,g|=(u=t.__digit(l))>>>32-d,d-=32);var p=_.__decideRounding(t,d,l,u);if((1===p||0===p&&1==(1&g))&&0==(g=g+1>>>0)&&0!=++c>>>20&&(c=0,1023<++a))return t.sign?-1/0:1/0;var v=t.sign?-2147483648:0;return a=a+1023<<20,_.__kBitConversionInts[1]=v|a|c,_.__kBitConversionInts[0]=g,_.__kBitConversionDouble[0]}},{key:"unaryMinus",value:function(t){if(0===t.length)return t;var e=t.__copy();return e.sign=!t.sign,e}},{key:"bitwiseNot",value:function(t){return t.sign?_.__absoluteSubOne(t).__trim():_.__absoluteAddOne(t,!0)}},{key:"exponentiate",value:function(t,e){if(e.sign)throw new RangeError("Exponent must be positive");if(0===e.length)return _.__oneDigit(1,!1);if(0===t.length)return t;if(1===t.length&&1===t.__digit(0))return t.sign&&0==(1&e.__digit(0))?_.unaryMinus(t):t;if(1<e.length)throw new RangeError("BigInt too big");var r=e.__unsignedDigit(0);if(1===r)return t;if(r>=_.__kMaxLengthBits)throw new RangeError("BigInt too big");if(1===t.length&&2===t.__digit(0)){var n=1+(r>>>5),i=new _(n,t.sign&&0!=(1&r));i.__initializeDigits();var o=1<<(31&r);return i.__setDigit(n-1,o),i}var a=null,u=t;for(0!=(1&r)&&(a=t),r>>=1;0!==r;r>>=1)u=_.multiply(u,u),0!=(1&r)&&(a=null===a?u:_.multiply(a,u));return a}},{key:"multiply",value:function(t,e){if(0===t.length)return t;if(0===e.length)return e;var r=t.length+e.length;32<=t.__clzmsd()+e.__clzmsd()&&r--;var n=new _(r,t.sign!==e.sign);n.__initializeDigits();for(var i=0;i<t.length;i++)_.__multiplyAccumulate(e,t.__digit(i),n,i);return n.__trim()}},{key:"divide",value:function(t,e){if(0===e.length)throw new RangeError("Division by zero");if(0>_.__absoluteCompare(t,e))return _.__zero();var r,n=t.sign!==e.sign,i=e.__unsignedDigit(0);if(1===e.length&&65535>=i){if(1===i)return n===t.sign?t:_.unaryMinus(t);r=_.__absoluteDivSmall(t,i,null)}else r=_.__absoluteDivLarge(t,e,!0,!1);return r.sign=n,r.__trim()}},{key:"remainder",value:function(t,e){if(0===e.length)throw new RangeError("Division by zero");if(0>_.__absoluteCompare(t,e))return t;var r=e.__unsignedDigit(0);if(1===e.length&&65535>=r){if(1===r)return _.__zero();var n=_.__absoluteModSmall(t,r);return 0===n?_.__zero():_.__oneDigit(n,t.sign)}var i=_.__absoluteDivLarge(t,e,!1,!0);return i.sign=t.sign,i.__trim()}},{key:"add",value:function(t,e){var r=t.sign;return r===e.sign?_.__absoluteAdd(t,e,r):0<=_.__absoluteCompare(t,e)?_.__absoluteSub(t,e,r):_.__absoluteSub(e,t,!r)}},{key:"subtract",value:function(t,e){var r=t.sign;return r===e.sign?0<=_.__absoluteCompare(t,e)?_.__absoluteSub(t,e,r):_.__absoluteSub(e,t,!r):_.__absoluteAdd(t,e,r)}},{key:"leftShift",value:function(t,e){return 0===e.length||0===t.length?t:e.sign?_.__rightShiftByAbsolute(t,e):_.__leftShiftByAbsolute(t,e)}},{key:"signedRightShift",value:function(t,e){return 0===e.length||0===t.length?t:e.sign?_.__leftShiftByAbsolute(t,e):_.__rightShiftByAbsolute(t,e)}},{key:"unsignedRightShift",value:function(){throw new TypeError("BigInts have no unsigned right shift; use >> instead")}},{key:"lessThan",value:function(t,e){return 0>_.__compareToBigInt(t,e)}},{key:"lessThanOrEqual",value:function(t,e){return 0>=_.__compareToBigInt(t,e)}},{key:"greaterThan",value:function(t,e){return 0<_.__compareToBigInt(t,e)}},{key:"greaterThanOrEqual",value:function(t,e){return 0<=_.__compareToBigInt(t,e)}},{key:"equal",value:function(t,e){if(t.sign!==e.sign)return!1;if(t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(t.__digit(r)!==e.__digit(r))return!1;return!0}},{key:"notEqual",value:function(t,e){return!_.equal(t,e)}},{key:"bitwiseAnd",value:function(t,e){if(!t.sign&&!e.sign)return _.__absoluteAnd(t,e).__trim();if(t.sign&&e.sign){var r=a(t.length,e.length)+1,n=_.__absoluteSubOne(t,r),i=_.__absoluteSubOne(e);return n=_.__absoluteOr(n,i,n),_.__absoluteAddOne(n,!0,n).__trim()}if(t.sign){var o=[e,t];t=o[0],e=o[1]}return _.__absoluteAndNot(t,_.__absoluteSubOne(e)).__trim()}},{key:"bitwiseXor",value:function(t,e){if(!t.sign&&!e.sign)return _.__absoluteXor(t,e).__trim();if(t.sign&&e.sign){var r=a(t.length,e.length),n=_.__absoluteSubOne(t,r),i=_.__absoluteSubOne(e);return _.__absoluteXor(n,i,n).__trim()}var o=a(t.length,e.length)+1;if(t.sign){var u=[e,t];t=u[0],e=u[1]}var s=_.__absoluteSubOne(e,o);return s=_.__absoluteXor(s,t,s),_.__absoluteAddOne(s,!0,s).__trim()}},{key:"bitwiseOr",value:function(t,e){var r=a(t.length,e.length);if(!t.sign&&!e.sign)return _.__absoluteOr(t,e).__trim();if(t.sign&&e.sign){var n=_.__absoluteSubOne(t,r),i=_.__absoluteSubOne(e);return n=_.__absoluteAnd(n,i,n),_.__absoluteAddOne(n,!0,n).__trim()}if(t.sign){var o=[e,t];t=o[0],e=o[1]}var u=_.__absoluteSubOne(e,r);return u=_.__absoluteAndNot(u,t,u),_.__absoluteAddOne(u,!0,u).__trim()}},{key:"asIntN",value:function(t,e){if(0===e.length)return e;if(0===t)return _.__zero();if(t>=_.__kMaxLengthBits)return e;var r=t+31>>>5;if(e.length<r)return e;var n=e.__unsignedDigit(r-1),i=1<<(31&t-1);if(e.length===r&&n<i)return e;if((n&i)!==i)return _.__truncateToNBits(t,e);if(!e.sign)return _.__truncateAndSubFromPowerOfTwo(t,e,!0);if(0==(n&i-1)){for(var o=r-2;0<=o;o--)if(0!==e.__digit(o))return _.__truncateAndSubFromPowerOfTwo(t,e,!1);return e.length===r&&n===i?e:_.__truncateToNBits(t,e)}return _.__truncateAndSubFromPowerOfTwo(t,e,!1)}},{key:"asUintN",value:function(t,e){if(0===e.length)return e;if(0===t)return _.__zero();if(e.sign){if(t>_.__kMaxLengthBits)throw new RangeError("BigInt too big");return _.__truncateAndSubFromPowerOfTwo(t,e,!1)}if(t>=_.__kMaxLengthBits)return e;var r=t+31>>>5;if(e.length<r)return e;var n=31&t;if(e.length==r){if(0===n)return e;if(0==e.__digit(r-1)>>>n)return e}return _.__truncateToNBits(t,e)}},{key:"ADD",value:function(t,e){if(t=_.__toPrimitive(t),e=_.__toPrimitive(e),"string"==typeof t)return"string"!=typeof e&&(e=e.toString()),t+e;if("string"==typeof e)return t.toString()+e;if(t=_.__toNumeric(t),e=_.__toNumeric(e),_.__isBigInt(t)&&_.__isBigInt(e))return _.add(t,e);if("number"==typeof t&&"number"==typeof e)return t+e;throw new TypeError("Cannot mix BigInt and other types, use explicit conversions")}},{key:"LT",value:function(t,e){return _.__compare(t,e,0)}},{key:"LE",value:function(t,e){return _.__compare(t,e,1)}},{key:"GT",value:function(t,e){return _.__compare(t,e,2)}},{key:"GE",value:function(t,e){return _.__compare(t,e,3)}},{key:"EQ",value:function(e,r){for(;;){if(_.__isBigInt(e))return _.__isBigInt(r)?_.equal(e,r):_.EQ(r,e);if("number"==typeof e){if(_.__isBigInt(r))return _.__equalToNumber(r,e);if("object"!==t(r))return e==r;r=_.__toPrimitive(r)}else if("string"==typeof e){if(_.__isBigInt(r))return null!==(e=_.__fromString(e))&&_.equal(e,r);if("object"!==t(r))return e==r;r=_.__toPrimitive(r)}else if("boolean"==typeof e){if(_.__isBigInt(r))return _.__equalToNumber(r,+e);if("object"!==t(r))return e==r;r=_.__toPrimitive(r)}else if("symbol"===t(e)){if(_.__isBigInt(r))return!1;if("object"!==t(r))return e==r;r=_.__toPrimitive(r)}else{if("object"!==t(e))return e==r;if("object"===t(r)&&r.constructor!==_)return e==r;e=_.__toPrimitive(e)}}}},{key:"NE",value:function(t,e){return!_.EQ(t,e)}},{key:"__zero",value:function(){return new _(0,!1)}},{key:"__oneDigit",value:function(t,e){var r=new _(1,e);return r.__setDigit(0,t),r}},{key:"__decideRounding",value:function(t,e,r,n){if(0<e)return-1;var i;if(0>e)i=-e-1;else{if(0===r)return-1;r--,n=t.__digit(r),i=31}var o=1<<i;if(0==(n&o))return-1;if(0!=(n&(o-=1)))return 1;for(;0<r;)if(r--,0!==t.__digit(r))return 1;return 0}},{key:"__fromDouble",value:function(t){_.__kBitConversionDouble[0]=t;var e,r=(2047&_.__kBitConversionInts[1]>>>20)-1023,n=1+(r>>>5),i=new _(n,0>t),o=1048575&_.__kBitConversionInts[1]|1048576,a=_.__kBitConversionInts[0],u=20,s=31&r,l=0;if(s<u){var f=u-s;l=f+32,e=o>>>f,o=o<<32-f|a>>>f,a<<=32-f}else if(s===u)l=32,e=o,o=a;else{var c=s-u;l=32-c,e=o<<c|a>>>32-c,o=a<<c}i.__setDigit(n-1,e);for(var h=n-2;0<=h;h--)0<l?(l-=32,e=o,o=a):e=0,i.__setDigit(h,e);return i.__trim()}},{key:"__isWhitespace",value:function(t){return!!(13>=t&&9<=t)||(159>=t?32==t:131071>=t?160==t||5760==t:196607>=t?10>=(t&=131071)||40==t||41==t||47==t||95==t||4096==t:65279==t)}},{key:"__fromString",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=0,n=t.length,i=0;if(i===n)return _.__zero();for(var o=t.charCodeAt(i);_.__isWhitespace(o);){if(++i===n)return _.__zero();o=t.charCodeAt(i)}if(43===o){if(++i===n)return null;o=t.charCodeAt(i),r=1}else if(45===o){if(++i===n)return null;o=t.charCodeAt(i),r=-1}if(0===e){if(e=10,48===o){if(++i===n)return _.__zero();if(88===(o=t.charCodeAt(i))||120===o){if(e=16,++i===n)return null;o=t.charCodeAt(i)}else if(79===o||111===o){if(e=8,++i===n)return null;o=t.charCodeAt(i)}else if(66===o||98===o){if(e=2,++i===n)return null;o=t.charCodeAt(i)}}}else if(16===e&&48===o){if(++i===n)return _.__zero();if(88===(o=t.charCodeAt(i))||120===o){if(++i===n)return null;o=t.charCodeAt(i)}}for(;48===o;){if(++i===n)return _.__zero();o=t.charCodeAt(i)}var a=n-i,u=_.__kMaxBitsPerChar[e],s=_.__kBitsPerCharTableMultiplier-1;if(a>1073741824/u)return null;var l=new _(31+(u*a+s>>>_.__kBitsPerCharTableShift)>>>5,!1),f=10>e?e:10,c=10<e?e-10:0;if(0==(e&e-1)){u>>=_.__kBitsPerCharTableShift;var h=[],g=[],d=!1;do{for(var p,v=0,y=0;;){if(p=void 0,o-48>>>0<f)p=o-48;else{if(!((32|o)-97>>>0<c)){d=!0;break}p=(32|o)-87}if(y+=u,v=v<<u|p,++i===n){d=!0;break}if(o=t.charCodeAt(i),32<y+u)break}h.push(v),g.push(y)}while(!d);_.__fillFromParts(l,h,g)}else{l.__initializeDigits();var b=!1,m=0;do{for(var w,k=0,D=1;;){if(w=void 0,o-48>>>0<f)w=o-48;else{if(!((32|o)-97>>>0<c)){b=!0;break}w=(32|o)-87}var B=D*e;if(4294967295<B)break;if(D=B,k=k*e+w,m++,++i===n){b=!0;break}o=t.charCodeAt(i)}var P=u*m+(s=32*_.__kBitsPerCharTableMultiplier-1)>>>_.__kBitsPerCharTableShift+5;l.__inplaceMultiplyAdd(D,k,P)}while(!b)}if(i!==n){if(!_.__isWhitespace(o))return null;for(i++;i<n;i++)if(o=t.charCodeAt(i),!_.__isWhitespace(o))return null}return 0!==r&&10!==e?null:(l.sign=-1===r,l.__trim())}},{key:"__fillFromParts",value:function(t,e,r){for(var n=0,i=0,o=0,a=e.length-1;0<=a;a--){var u=e[a],s=r[a];i|=u<<o,32===(o+=s)?(t.__setDigit(n++,i),o=0,i=0):32<o&&(t.__setDigit(n++,i),i=u>>>s-(o-=32))}if(0!==i){if(n>=t.length)throw new Error("implementation bug");t.__setDigit(n++,i)}for(;n<t.length;n++)t.__setDigit(n,0)}},{key:"__toStringBasePowerOfTwo",value:function(t,e){var r=t.length,n=e-1,i=n=(15&(n=(51&(n=(85&n>>>1)+(85&n))>>>2)+(51&n))>>>4)+(15&n),o=e-1,a=t.__digit(r-1),u=0|(32*r-s(a)+i-1)/i;if(t.sign&&u++,268435456<u)throw new Error("string too long");for(var l=Array(u),f=u-1,c=0,h=0,g=0;g<r-1;g++){var d=t.__digit(g),p=(c|d<<h)&o;l[f--]=_.__kConversionChars[p];var v=i-h;for(c=d>>>v,h=32-v;h>=i;)l[f--]=_.__kConversionChars[c&o],c>>>=i,h-=i}var y=(c|a<<h)&o;for(l[f--]=_.__kConversionChars[y],c=a>>>i-h;0!==c;)l[f--]=_.__kConversionChars[c&o],c>>>=i;if(t.sign&&(l[f--]="-"),-1!==f)throw new Error("implementation bug");return l.join("")}},{key:"__toStringGeneric",value:function(t,e,r){var n=t.length;if(0===n)return"";if(1===n){var i=t.__unsignedDigit(0).toString(e);return!1===r&&t.sign&&(i="-"+i),i}var o,a,u=32*n-s(t.__digit(n-1)),l=_.__kMaxBitsPerChar[e]-1,f=u*_.__kBitsPerCharTableMultiplier,c=1+(f=0|(f+=l-1)/l)>>1,h=_.exponentiate(_.__oneDigit(e,!1),_.__oneDigit(c,!1)),g=h.__unsignedDigit(0);if(1===h.length&&65535>=g){(o=new _(t.length,!1)).__initializeDigits();for(var d,p=0,v=2*t.length-1;0<=v;v--)d=p<<16|t.__halfDigit(v),o.__setHalfDigit(v,0|d/g),p=0|d%g;a=p.toString(e)}else{var y=_.__absoluteDivLarge(t,h,!0,!0);o=y.quotient;var b=y.remainder.__trim();a=_.__toStringGeneric(b,e,!0)}o.__trim();for(var m=_.__toStringGeneric(o,e,!0);a.length<c;)a="0"+a;return!1===r&&t.sign&&(m="-"+m),m+a}},{key:"__unequalSign",value:function(t){return t?-1:1}},{key:"__absoluteGreater",value:function(t){return t?-1:1}},{key:"__absoluteLess",value:function(t){return t?1:-1}},{key:"__compareToBigInt",value:function(t,e){var r=t.sign;if(r!==e.sign)return _.__unequalSign(r);var n=_.__absoluteCompare(t,e);return 0<n?_.__absoluteGreater(r):0>n?_.__absoluteLess(r):0}},{key:"__compareToNumber",value:function(t,e){if(!0|e){var r=t.sign,n=0>e;if(r!==n)return _.__unequalSign(r);if(0===t.length){if(n)throw new Error("implementation bug");return 0===e?0:-1}if(1<t.length)return _.__absoluteGreater(r);var i=o(e),a=t.__unsignedDigit(0);return a>i?_.__absoluteGreater(r):a<i?_.__absoluteLess(r):0}return _.__compareToDouble(t,e)}},{key:"__compareToDouble",value:function(t,e){if(e!=e)return e;if(e===1/0)return-1;if(e===-1/0)return 1;var r=t.sign;if(r!==0>e)return _.__unequalSign(r);if(0===e)throw new Error("implementation bug: should be handled elsewhere");if(0===t.length)return-1;_.__kBitConversionDouble[0]=e;var n=2047&_.__kBitConversionInts[1]>>>20;if(2047==n)throw new Error("implementation bug: handled elsewhere");var i=n-1023;if(0>i)return _.__absoluteGreater(r);var o=t.length,a=t.__digit(o-1),u=s(a),l=32*o-u,f=i+1;if(l<f)return _.__absoluteLess(r);if(l>f)return _.__absoluteGreater(r);var c=1048576|1048575&_.__kBitConversionInts[1],h=_.__kBitConversionInts[0],g=20,d=31-u;if(d!==(l-1)%31)throw new Error("implementation bug");var p,v=0;if(d<g){var y=g-d;v=y+32,p=c>>>y,c=c<<32-y|h>>>y,h<<=32-y}else if(d===g)v=32,p=c,c=h;else{var b=d-g;v=32-b,p=c<<b|h>>>32-b,c=h<<b}if((a>>>=0)>(p>>>=0))return _.__absoluteGreater(r);if(a<p)return _.__absoluteLess(r);for(var m=o-2;0<=m;m--){0<v?(v-=32,p=c>>>0,c=h,h=0):p=0;var w=t.__unsignedDigit(m);if(w>p)return _.__absoluteGreater(r);if(w<p)return _.__absoluteLess(r)}if(0!==c||0!==h){if(0===v)throw new Error("implementation bug");return _.__absoluteLess(r)}return 0}},{key:"__equalToNumber",value:function(t,e){return e|0===e?0===e?0===t.length:1===t.length&&t.sign===0>e&&t.__unsignedDigit(0)===o(e):0===_.__compareToDouble(t,e)}},{key:"__comparisonResultToBool",value:function(t,e){switch(e){case 0:return 0>t;case 1:return 0>=t;case 2:return 0<t;case 3:return 0<=t}throw new Error("unreachable")}},{key:"__compare",value:function(t,e,r){if(t=_.__toPrimitive(t),e=_.__toPrimitive(e),"string"==typeof t&&"string"==typeof e)switch(r){case 0:return t<e;case 1:return t<=e;case 2:return t>e;case 3:return t>=e}if(_.__isBigInt(t)&&"string"==typeof e)return null!==(e=_.__fromString(e))&&_.__comparisonResultToBool(_.__compareToBigInt(t,e),r);if("string"==typeof t&&_.__isBigInt(e))return null!==(t=_.__fromString(t))&&_.__comparisonResultToBool(_.__compareToBigInt(t,e),r);if(t=_.__toNumeric(t),e=_.__toNumeric(e),_.__isBigInt(t)){if(_.__isBigInt(e))return _.__comparisonResultToBool(_.__compareToBigInt(t,e),r);if("number"!=typeof e)throw new Error("implementation bug");return _.__comparisonResultToBool(_.__compareToNumber(t,e),r)}if("number"!=typeof t)throw new Error("implementation bug");if(_.__isBigInt(e))return _.__comparisonResultToBool(_.__compareToNumber(e,t),2^r);if("number"!=typeof e)throw new Error("implementation bug");return 0===r?t<e:1===r?t<=e:2===r?t>e:3===r?t>=e:void 0}},{key:"__absoluteAdd",value:function(t,e,r){if(t.length<e.length)return _.__absoluteAdd(e,t,r);if(0===t.length)return t;if(0===e.length)return t.sign===r?t:_.unaryMinus(t);var n=t.length;(0===t.__clzmsd()||e.length===t.length&&0===e.__clzmsd())&&n++;for(var i=new _(n,r),o=0,a=0;a<e.length;a++){var u=e.__digit(a),s=t.__digit(a),l=(65535&s)+(65535&u)+o,f=(s>>>16)+(u>>>16)+(l>>>16);o=f>>>16,i.__setDigit(a,65535&l|f<<16)}for(;a<t.length;a++){var c=t.__digit(a),h=(65535&c)+o,g=(c>>>16)+(h>>>16);o=g>>>16,i.__setDigit(a,65535&h|g<<16)}return a<i.length&&i.__setDigit(a,o),i.__trim()}},{key:"__absoluteSub",value:function(t,e,r){if(0===t.length)return t;if(0===e.length)return t.sign===r?t:_.unaryMinus(t);for(var n=new _(t.length,r),i=0,o=0;o<e.length;o++){var a=t.__digit(o),u=e.__digit(o),s=(65535&a)-(65535&u)-i,l=(a>>>16)-(u>>>16)-(i=1&s>>>16);i=1&l>>>16,n.__setDigit(o,65535&s|l<<16)}for(;o<t.length;o++){var f=t.__digit(o),c=(65535&f)-i,h=(f>>>16)-(i=1&c>>>16);i=1&h>>>16,n.__setDigit(o,65535&c|h<<16)}return n.__trim()}},{key:"__absoluteAddOne",value:function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=t.length;null===r?r=new _(n,e):r.sign=e;for(var i,o=!0,a=0;a<n;a++){if(i=t.__digit(a),o){var u=-1===i;i=0|i+1,o=u}r.__setDigit(a,i)}return o&&r.__setDigitGrow(n,1),r}},{key:"__absoluteSubOne",value:function(t,e){for(var r,n=t.length,i=new _(e=e||n,!1),o=!0,a=0;a<n;a++){if(r=t.__digit(a),o){var u=0===r;r=0|r-1,o=u}i.__setDigit(a,r)}if(o)throw new Error("implementation bug");for(var s=n;s<e;s++)i.__setDigit(s,0);return i}},{key:"__absoluteAnd",value:function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=t.length,i=e.length,o=i;if(n<i){o=n;var a=t,u=n;t=e,n=i,e=a,i=u}var s=o;null===r?r=new _(s,!1):s=r.length;for(var l=0;l<o;l++)r.__setDigit(l,t.__digit(l)&e.__digit(l));for(;l<s;l++)r.__setDigit(l,0);return r}},{key:"__absoluteAndNot",value:function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=t.length,i=e.length,o=i;n<i&&(o=n);var a=n;null===r?r=new _(a,!1):a=r.length;for(var u=0;u<o;u++)r.__setDigit(u,t.__digit(u)&~e.__digit(u));for(;u<n;u++)r.__setDigit(u,t.__digit(u));for(;u<a;u++)r.__setDigit(u,0);return r}},{key:"__absoluteOr",value:function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=t.length,i=e.length,o=i;if(n<i){o=n;var a=t,u=n;t=e,n=i,e=a,i=u}var s=n;null===r?r=new _(s,!1):s=r.length;for(var l=0;l<o;l++)r.__setDigit(l,t.__digit(l)|e.__digit(l));for(;l<n;l++)r.__setDigit(l,t.__digit(l));for(;l<s;l++)r.__setDigit(l,0);return r}},{key:"__absoluteXor",value:function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=t.length,i=e.length,o=i;if(n<i){o=n;var a=t,u=n;t=e,n=i,e=a,i=u}var s=n;null===r?r=new _(s,!1):s=r.length;for(var l=0;l<o;l++)r.__setDigit(l,t.__digit(l)^e.__digit(l));for(;l<n;l++)r.__setDigit(l,t.__digit(l));for(;l<s;l++)r.__setDigit(l,0);return r}},{key:"__absoluteCompare",value:function(t,e){var r=t.length-e.length;if(0!=r)return r;for(var n=t.length-1;0<=n&&t.__digit(n)===e.__digit(n);)n--;return 0>n?0:t.__unsignedDigit(n)>e.__unsignedDigit(n)?1:-1}},{key:"__multiplyAccumulate",value:function(t,e,r,n){if(0!==e){for(var i=65535&e,o=e>>>16,a=0,s=0,_=0,l=0;l<t.length;l++,n++){var f=r.__digit(n),c=65535&f,h=f>>>16,g=t.__digit(l),d=65535&g,p=g>>>16,v=u(d,i),y=u(d,o),b=u(p,i),m=u(p,o);a=(s=(y>>>16)+(b>>>16)+(65535&m)+(a=(h+=_+a+((c+=s+(65535&v))>>>16)+(v>>>16)+(65535&y)+(65535&b))>>>16))>>>16,s&=65535,_=m>>>16,f=65535&c|h<<16,r.__setDigit(n,f)}for(;0!==a||0!==s||0!==_;n++){var w=r.__digit(n),k=(65535&w)+s,D=(w>>>16)+(k>>>16)+_+a;s=0,_=0,a=D>>>16,w=65535&k|D<<16,r.__setDigit(n,w)}}}},{key:"__internalMultiplyAdd",value:function(t,e,r,n,i){for(var o=r,a=0,s=0;s<n;s++){var _=t.__digit(s),l=u(65535&_,e),f=(65535&l)+a+o;o=f>>>16;var c=u(_>>>16,e),h=(65535&c)+(l>>>16)+o;o=h>>>16,a=c>>>16,i.__setDigit(s,h<<16|65535&f)}if(i.length>n)for(i.__setDigit(n++,o+a);n<i.length;)i.__setDigit(n++,0);else if(0!==o+a)throw new Error("implementation bug")}},{key:"__absoluteDivSmall",value:function(t,e,r){null===r&&(r=new _(t.length,!1));for(var n=0,i=2*t.length-1;0<=i;i-=2){var o=(n<<16|t.__halfDigit(i))>>>0,a=0|o/e,u=0|(o=((n=0|o%e)<<16|t.__halfDigit(i-1))>>>0)/e;n=0|o%e,r.__setDigit(i>>>1,a<<16|u)}return r}},{key:"__absoluteModSmall",value:function(t,e){for(var r=0,n=2*t.length-1;0<=n;n--)r=0|((r<<16|t.__halfDigit(n))>>>0)%e;return r}},{key:"__absoluteDivLarge",value:function(t,e,r,n){var i=e.__halfDigitLength(),o=e.length,a=t.__halfDigitLength()-i,s=null;r&&(s=new _(a+2>>>1,!1)).__initializeDigits();var l=new _(i+2>>>1,!1);l.__initializeDigits();var f=_.__clz16(e.__halfDigit(i-1));0<f&&(e=_.__specialLeftShift(e,f,0));for(var c=_.__specialLeftShift(t,f,1),h=e.__halfDigit(i-1),g=0,d=a;0<=d;d--){var p=65535,v=c.__halfDigit(d+i);if(v!==h){var y=(v<<16|c.__halfDigit(d+i-1))>>>0;p=0|y/h;for(var b=0|y%h,m=e.__halfDigit(i-2),w=c.__halfDigit(d+i-2);u(p,m)>>>0>(b<<16|w)>>>0&&(p--,!(65535<(b+=h))););}_.__internalMultiplyAdd(e,p,0,o,l);var k=c.__inplaceSub(l,d,i+1);0!==k&&(k=c.__inplaceAdd(e,d,i),c.__setHalfDigit(d+i,c.__halfDigit(d+i)+k),p--),r&&(1&d?g=p<<16:s.__setDigit(d>>>1,g|p))}return n?(c.__inplaceRightShift(f),r?{quotient:s,remainder:c}:c):r?s:void 0}},{key:"__clz16",value:function(t){return s(t)-16}},{key:"__specialLeftShift",value:function(t,e,r){var n=t.length,i=new _(n+r,!1);if(0===e){for(var o=0;o<n;o++)i.__setDigit(o,t.__digit(o));return 0<r&&i.__setDigit(n,0),i}for(var a,u=0,s=0;s<n;s++)a=t.__digit(s),i.__setDigit(s,a<<e|u),u=a>>>32-e;return 0<r&&i.__setDigit(n,u),i}},{key:"__leftShiftByAbsolute",value:function(t,e){var r=_.__toShiftAmount(e);if(0>r)throw new RangeError("BigInt too big");var n=r>>>5,i=31&r,o=t.length,a=0!==i&&0!=t.__digit(o-1)>>>32-i,u=o+n+(a?1:0),s=new _(u,t.sign);if(0===i){for(var l=0;l<n;l++)s.__setDigit(l,0);for(;l<u;l++)s.__setDigit(l,t.__digit(l-n))}else{for(var f=0,c=0;c<n;c++)s.__setDigit(c,0);for(var h,g=0;g<o;g++)h=t.__digit(g),s.__setDigit(g+n,h<<i|f),f=h>>>32-i;if(a)s.__setDigit(o+n,f);else if(0!==f)throw new Error("implementation bug")}return s.__trim()}},{key:"__rightShiftByAbsolute",value:function(t,e){var r=t.length,n=t.sign,i=_.__toShiftAmount(e);if(0>i)return _.__rightShiftByMaximum(n);var o=i>>>5,a=31&i,u=r-o;if(0>=u)return _.__rightShiftByMaximum(n);var s=!1;if(n)if(0!=(t.__digit(o)&(1<<a)-1))s=!0;else for(var l=0;l<o;l++)if(0!==t.__digit(l)){s=!0;break}s&&0===a&&0==~t.__digit(r-1)&&u++;var f=new _(u,n);if(0===a)for(var c=o;c<r;c++)f.__setDigit(c-o,t.__digit(c));else{for(var h,g=t.__digit(o)>>>a,d=r-o-1,p=0;p<d;p++)h=t.__digit(p+o+1),f.__setDigit(p,h<<32-a|g),g=h>>>a;f.__setDigit(d,g)}return s&&(f=_.__absoluteAddOne(f,!0,f)),f.__trim()}},{key:"__rightShiftByMaximum",value:function(t){return t?_.__oneDigit(1,!0):_.__zero()}},{key:"__toShiftAmount",value:function(t){if(1<t.length)return-1;var e=t.__unsignedDigit(0);return e>_.__kMaxLengthBits?-1:e}},{key:"__toPrimitive",value:function(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"default";if("object"!==t(e))return e;if(e.constructor===_)return e;var n=e[Symbol.toPrimitive];if(n){var i=n(r);if("object"!==t(i))return i;throw new TypeError("Cannot convert object to primitive value")}var o=e.valueOf;if(o){var a=o.call(e);if("object"!==t(a))return a}var u=e.toString;if(u){var s=u.call(e);if("object"!==t(s))return s}throw new TypeError("Cannot convert object to primitive value")}},{key:"__toNumeric",value:function(t){return _.__isBigInt(t)?t:+t}},{key:"__isBigInt",value:function(e){return"object"===t(e)&&e.constructor===_}},{key:"__truncateToNBits",value:function(t,e){for(var r=t+31>>>5,n=new _(r,e.sign),i=r-1,o=0;o<i;o++)n.__setDigit(o,e.__digit(o));var a=e.__digit(i);if(0!=(31&t)){var u=32-(31&t);a=a<<u>>>u}return n.__setDigit(i,a),n.__trim()}},{key:"__truncateAndSubFromPowerOfTwo",value:function(t,e,r){for(var n=Math.min,i=t+31>>>5,o=new _(i,r),a=0,u=i-1,s=0,l=n(u,e.length);a<l;a++){var f=e.__digit(a),c=0-(65535&f)-s,h=0-(f>>>16)-(s=1&c>>>16);s=1&h>>>16,o.__setDigit(a,65535&c|h<<16)}for(;a<u;a++)o.__setDigit(a,0|-s);var g,d=u<e.length?e.__digit(u):0,p=31&t;if(0===p){var v=0-(65535&d)-s;g=65535&v|0-(d>>>16)-(s=1&v>>>16)<<16}else{var y=32-p,b=1<<32-y,m=(65535&b)-(65535&(d=d<<y>>>y))-s;g=65535&m|(b>>>16)-(d>>>16)-(s=1&m>>>16)<<16,g&=b-1}return o.__setDigit(u,g),o.__trim()}},{key:"__digitPow",value:function(t,e){for(var r=1;0<e;)1&e&&(r*=t),e>>>=1,t*=t;return r}}]),_}(l(Array));return v.__kMaxLength=33554432,v.__kMaxLengthBits=v.__kMaxLength<<5,v.__kMaxBitsPerChar=[0,0,32,51,64,75,83,90,96,102,107,111,115,119,122,126,128,131,134,136,139,141,143,145,147,149,151,153,154,156,158,159,160,162,163,165,166],v.__kBitsPerCharTableShift=5,v.__kBitsPerCharTableMultiplier=1<<v.__kBitsPerCharTableShift,v.__kConversionChars=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],v.__kBitConversionBuffer=new ArrayBuffer(8),v.__kBitConversionDouble=new Float64Array(v.__kBitConversionBuffer),v.__kBitConversionInts=new Int32Array(v.__kBitConversionBuffer),v}()}));function u(t,e,r,n=[]){!function(t,e){if(!(e instanceof Object))throw new Error(`${t} is not an object!`)}(t,e);const i=Object.keys(e).sort(),o=r.length,a=r.length+n.length,u=`${t} does not have correct keys! Required keys: [${r.sort().join(", ")}], optional keys: [${n.sort().join(", ")}], actual keys: [${i.join(", ")}]`;if(i.length<o||i.length>a)throw new Error(u);let s=i.filter((t=>!r.includes(t)));if(i.length-s.length!==o)throw new Error(u);if(s.find((t=>!n.includes(t))))throw new Error(u)}function s(t,e){if(!/^0x([0-9a-fA-F][0-9a-fA-F])*$/.test(e))throw new Error(`${t} must be a hex string!`)}function _(t,e){if(s(t,e),66!=e.length)throw new Error(`${t} must be a hex string of 66 bytes long!`)}function l(t,e){if("0x0"!==e&&!/^0x[1-9a-fA-F][0-9a-fA-F]*$/.test(e))throw new Error(`${t} must be a hex integer!`)}function f(t,{nestedValidation:e=!0,debugPath:r="script"}={}){if(u(r,t,["code_hash","hash_type","args"],[]),_(`${r}.code_hash`,t.code_hash),s(`${r}.args`,t.args),"data"!==t.hash_type&&"type"!==t.hash_type)throw new Error(`${r}.hash_type must be either data or type!`)}function c(t,{nestedValidation:e=!0,debugPath:r="out_point"}={}){u(r,t,["tx_hash","index"],[]),_(`${r}.tx_hash`,t.tx_hash),l(`${r}.index`,t.index)}function h(t,{nestedValidation:e=!0,debugPath:r="cell_input"}={}){u(r,t,["since","previous_output"],[]),l(`${r}.since`,t.since),e&&c(t.previous_output,{debugPath:`${r}.previous_output`})}function g(t,{nestedValidation:e=!0,debugPath:r="cell_output"}={}){u(r,t,["capacity","lock"],["type"]),l(`${r}.capacity`,t.capacity),e&&(f(t.lock,{debugPath:`${r}.lock`}),t.type&&f(t.type,{debugPath:`${r}.type`}))}function d(t,{nestedValidation:e=!0,debugPath:r="cell_dep"}={}){if(u(r,t,["out_point","dep_type"],[]),"code"!==t.dep_type&&"dep_group"!==t.dep_type)throw new Error(`${r}.dep_type must be either code or dep_group!`);e&&c(t.out_point,{debugPath:`${r}.out_point`})}function p(t,e,r,n){if(!Array.isArray(e))throw new Error(`${t} is not an array!`);if(n)for(let n=0;n<e.length;n++)r(`${t}[${n}]`,e[n])}function v(t,e){return function(r,n){t(n,{nestedValidation:e,debugPath:r})}}function y(t,e,r){l(`${t}.version`,e.version),p(`${t}.cell_deps`,e.cell_deps,v(d,r),r),p(`${t}.header_deps`,e.header_deps,_,r),p(`${t}.inputs`,e.inputs,v(h,r),r),p(`${t}.outputs`,e.outputs,v(g,r),r),p(`${t}.outputs_data`,e.outputs_data,s,r)}function b(t,{nestedValidation:e=!0,debugPath:r="raw_transaction"}={}){u(r,t,["version","cell_deps","header_deps","inputs","outputs","outputs_data"],[]),y(r,t,e)}function m(t,{nestedValidation:e=!0,debugPath:r="transaction"}={}){u(r,t,["version","cell_deps","header_deps","inputs","outputs","outputs_data","witnesses"],[]),y(r,t,e),p(`${r}.witnesses`,t.witnesses,s,e)}function w(t,{nestedValidation:e=!0,debugPath:r="raw_header"}={}){u(r,t,["version","compact_target","timestamp","number","epoch","parent_hash","transactions_root","proposals_hash","uncles_hash","dao"],[]),function(t,e){l(`${t}.version`,e.version),l(`${t}.compact_target`,e.compact_target),l(`${t}.timestamp`,e.timestamp),l(`${t}.number`,e.number),l(`${t}.epoch`,e.epoch),_(`${t}.parent_hash`,e.parent_hash),_(`${t}.transactions_root`,e.transactions_root),_(`${t}.proposals_hash`,e.proposals_hash),_(`${t}.uncles_hash`,e.uncles_hash),_(`${t}.dao`,e.dao)}(r,t)}function k(t,{nestedValidation:e=!0,debugPath:r="header"}={}){if(u(r,t,["version","compact_target","timestamp","number","epoch","parent_hash","transactions_root","proposals_hash","uncles_hash","dao","nonce"],[]),s(`${r}.nonce`,t.nonce),34!=t.nonce.length)throw new Error(`${r}.nonce must be a hex string of 34 bytes long!`)}function D(t,e){if(s(t,e),22!=e.length)throw new Error(`${t} must be a hex string of 22 bytes long!`)}function B(t,{nestedValidation:e=!0,debugPath:r="uncle_block"}={}){u(r,t,["header","proposals"],[]),e&&k(t.header,{debugPath:`${r}.header`}),p(`${r}.proposals`,t.proposals,D,e)}function P(t,{nestedValidation:e=!0,debugPath:r="block"}={}){u(r,t,["header","uncles","transactions","proposals"],[]),e&&k(t.header,{debugPath:`${r}.header`}),p(`${r}.uncles`,t.uncles,v(B,e),e),p(`${r}.transactions`,t.transactions,v(m,e),e),p(`${r}.proposals`,t.proposals,D,e)}function A(t,{nestedValidation:e=!0,debugPath:r="cellbase_witness"}={}){u(r,t,["lock","message"],[]),s(`${r}.message`,t.message),e&&f(t.lock,{debugPath:`${r}.lock`})}function T(t,{nestedValidation:e=!0,debugPath:r="witness_args"}={}){u(r,t,[],["lock","input_type","output_type"]),t.lock&&s(`${r}.lock`,t.lock),t.input_type&&s(`${r}.input_type`,t.input_type),t.output_type&&s(`${r}.output_type`,t.output_type)}var S=Object.freeze({__proto__:null,ValidateScript:f,ValidateOutPoint:c,ValidateCellInput:h,ValidateCellOutput:g,ValidateCellDep:d,ValidateRawTransaction:b,ValidateTransaction:m,ValidateRawHeader:w,ValidateHeader:k,ValidateUncleBlock:B,ValidateBlock:P,ValidateCellbaseWitness:A,ValidateWitnessArgs:T});var E=o((function(t,e){var r=function(t){function e(){this.fetch=!1,this.DOMException=t.DOMException}return e.prototype=t,new e}("undefined"!=typeof self?self:i);!function(t){!function(e){var r="URLSearchParams"in t,n="Symbol"in t&&"iterator"in Symbol,i="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),o="FormData"in t,a="ArrayBuffer"in t;if(a)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],s=ArrayBuffer.isView||function(t){return t&&u.indexOf(Object.prototype.toString.call(t))>-1};function _(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function l(t){return"string"!=typeof t&&(t=String(t)),t}function f(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return n&&(e[Symbol.iterator]=function(){return e}),e}function c(t){this.map={},t instanceof c?t.forEach((function(t,e){this.append(e,t)}),this):Array.isArray(t)?t.forEach((function(t){this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function h(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function g(t){return new Promise((function(e,r){t.onload=function(){e(t.result)},t.onerror=function(){r(t.error)}}))}function d(t){var e=new FileReader,r=g(e);return e.readAsArrayBuffer(t),r}function p(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function v(){return this.bodyUsed=!1,this._initBody=function(t){var e;this._bodyInit=t,t?"string"==typeof t?this._bodyText=t:i&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:o&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:r&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():a&&i&&((e=t)&&DataView.prototype.isPrototypeOf(e))?(this._bodyArrayBuffer=p(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a&&(ArrayBuffer.prototype.isPrototypeOf(t)||s(t))?this._bodyArrayBuffer=p(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i&&(this.blob=function(){var t=h(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?h(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(d)}),this.text=function(){var t,e,r,n=h(this);if(n)return n;if(this._bodyBlob)return t=this._bodyBlob,e=new FileReader,r=g(e),e.readAsText(t),r;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),r=new Array(e.length),n=0;n<e.length;n++)r[n]=String.fromCharCode(e[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o&&(this.formData=function(){return this.text().then(m)}),this.json=function(){return this.text().then(JSON.parse)},this}c.prototype.append=function(t,e){t=_(t),e=l(e);var r=this.map[t];this.map[t]=r?r+", "+e:e},c.prototype.delete=function(t){delete this.map[_(t)]},c.prototype.get=function(t){return t=_(t),this.has(t)?this.map[t]:null},c.prototype.has=function(t){return this.map.hasOwnProperty(_(t))},c.prototype.set=function(t,e){this.map[_(t)]=l(e)},c.prototype.forEach=function(t,e){for(var r in this.map)this.map.hasOwnProperty(r)&&t.call(e,this.map[r],r,this)},c.prototype.keys=function(){var t=[];return this.forEach((function(e,r){t.push(r)})),f(t)},c.prototype.values=function(){var t=[];return this.forEach((function(e){t.push(e)})),f(t)},c.prototype.entries=function(){var t=[];return this.forEach((function(e,r){t.push([r,e])})),f(t)},n&&(c.prototype[Symbol.iterator]=c.prototype.entries);var y=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function b(t,e){var r,n,i=(e=e||{}).body;if(t instanceof b){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new c(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,i||null==t._bodyInit||(i=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new c(e.headers)),this.method=(r=e.method||this.method||"GET",n=r.toUpperCase(),y.indexOf(n)>-1?n:r),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function m(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var r=t.split("="),n=r.shift().replace(/\+/g," "),i=r.join("=").replace(/\+/g," ");e.append(decodeURIComponent(n),decodeURIComponent(i))}})),e}function w(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new c(e.headers),this.url=e.url||"",this._initBody(t)}b.prototype.clone=function(){return new b(this,{body:this._bodyInit})},v.call(b.prototype),v.call(w.prototype),w.prototype.clone=function(){return new w(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new c(this.headers),url:this.url})},w.error=function(){var t=new w(null,{status:0,statusText:""});return t.type="error",t};var k=[301,302,303,307,308];w.redirect=function(t,e){if(-1===k.indexOf(e))throw new RangeError("Invalid status code");return new w(null,{status:e,headers:{location:t}})},e.DOMException=t.DOMException;try{new e.DOMException}catch(t){e.DOMException=function(t,e){this.message=t,this.name=e;var r=Error(t);this.stack=r.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function D(t,r){return new Promise((function(n,o){var a=new b(t,r);if(a.signal&&a.signal.aborted)return o(new e.DOMException("Aborted","AbortError"));var u=new XMLHttpRequest;function s(){u.abort()}u.onload=function(){var t,e,r={status:u.status,statusText:u.statusText,headers:(t=u.getAllResponseHeaders()||"",e=new c,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(t){var r=t.split(":"),n=r.shift().trim();if(n){var i=r.join(":").trim();e.append(n,i)}})),e)};r.url="responseURL"in u?u.responseURL:r.headers.get("X-Request-URL");var i="response"in u?u.response:u.responseText;n(new w(i,r))},u.onerror=function(){o(new TypeError("Network request failed"))},u.ontimeout=function(){o(new TypeError("Network request failed"))},u.onabort=function(){o(new e.DOMException("Aborted","AbortError"))},u.open(a.method,a.url,!0),"include"===a.credentials?u.withCredentials=!0:"omit"===a.credentials&&(u.withCredentials=!1),"responseType"in u&&i&&(u.responseType="blob"),a.headers.forEach((function(t,e){u.setRequestHeader(e,t)})),a.signal&&(a.signal.addEventListener("abort",s),u.onreadystatechange=function(){4===u.readyState&&a.signal.removeEventListener("abort",s)}),u.send(void 0===a._bodyInit?null:a._bodyInit)}))}D.polyfill=!0,t.fetch||(t.fetch=D,t.Headers=c,t.Request=b,t.Response=w),e.Headers=c,e.Request=b,e.Response=w,e.fetch=D}({})}(r),delete r.fetch.polyfill,(e=r.fetch).default=r.fetch,e.fetch=r.fetch,e.Headers=r.Headers,e.Request=r.Request,e.Response=r.Response,t.exports=e}));function x(t,e){e=e||{};const r=Object.assign({},e.headers||{},t.headers||{});return Object.assign({},e,t,{headers:r})}const O={get:(t,e,r)=>"send"===e?async()=>{const e=await E(t.uri,x({method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(t.payload)},t.defaultOptions));return await e.json()}:(...n)=>{const i=t.id;return t.id=t.id+1,t.payload.push({jsonrpc:"2.0",id:i,method:e,params:n}),r}},C={get:(t,e)=>"batch"===e?()=>new Proxy({id:Math.round(1e7*Math.random()),payload:[],uri:t.uri,defaultOptions:t.defaultOptions},O):async(...r)=>{const n=Math.round(1e7*Math.random()),i=await E(t.uri,x({method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",id:n,method:e,params:r})},t.defaultOptions)),o=await i.json();if(o.id!==n)throw new Error("JSONRPCError: response ID does not match request ID!");if(o.error)throw new Error(`JSONRPCError: server error ${JSON.stringify(o.error)}`);return o.result}};class ${constructor(t,e={}){return this.uri=t,this.defaultOptions=e,new Proxy(this,C)}static create(t){return new $(t)}}function I(t){return a.BigInt(t)}function j(t){return"0x"+t.toString(16)}function R(t){return function(e,r){if(!(r instanceof ArrayBuffer)){let n=j(a.BigInt(r)).substr(2);if(n.length%2!=0&&(n="0"+n),n.length/2>t)throw new Error(`${e} is ${n.length/2} bytes long, expected length is ${t}!`);const i=new DataView(new ArrayBuffer(t));for(let t=0;t<n.length/2;t++){const e=n.length-2*(t+1);i.setUint8(t,parseInt(n.substr(e,2),16))}r=i.buffer}if(r.byteLength<t){const e=new Uint8Array(t);e.set(new Uint8Array(r),0),r=e.buffer}return r}}function z(t){return function(e,r){if(r=new n(r).toArrayBuffer(),t>0&&r.byteLength!==t)throw new Error(`${e} has invalid length ${r.byteLength}, required: ${t}`);return r}}function M(t,e,r){const n={};for(const[i,o]of Object.entries(r)){const r=e[i];if(!r)throw new Error(`${t} is missing ${i}!`);n[i]=o(`${t}.${i}`,r)}return n}function N(t,{debugPath:e="script"}={}){return M(e,t,{code_hash:z(32),hash_type:function(t,e){switch(e){case"data":return 0;case"type":return 1;case 0:case 1:return e;default:throw new Error(`${t}.hash_type has invalid value: ${e}`)}},args:z(-1)})}function L(t,{debugPath:e="out_point"}={}){return M(e,t,{tx_hash:z(32),index:R(4)})}function U(t){return function(e,r){return t(r,{debugPath:e})}}function V(t,{debugPath:e="cell_input"}={}){return M(e,t,{since:R(8),previous_output:U(L)})}function q(t,{debugPath:e="cell_output"}={}){const r=M(e,t,{capacity:R(8),lock:U(N)});return t.type&&(r.type_=N(t.type,{debugPath:`${e}.type`})),r}function F(t,{debugPath:e="cell_dep"}={}){return M(e,t,{out_point:U(L),dep_type:function(t,e){switch(e){case"code":return 0;case"dep_group":return 1;case 0:case 1:return e;default:throw new Error(`${t}.dep_type has invalid value: ${e}`)}}})}function H(t){return function(e,r){return r.map(((r,n)=>t(`${e}[${n}]`,r)))}}function G(t,{debugPath:e="raw_transaction"}={}){return M(e,t,{version:R(4),cell_deps:H(U(F)),header_deps:H(z(32)),inputs:H(U(V)),outputs:H(U(q)),outputs_data:H(z(-1))})}function W(t,{debugPath:e="transaction"}={}){const r=G(t,{debugPath:`(raw)${e}`}),n=M(e,t,{witnesses:H(z(-1))});return n.raw=r,n}function J(t,{debugPath:e="raw_header"}={}){return M(e,t,{version:R(4),compact_target:R(4),timestamp:R(8),number:R(8),epoch:R(8),parent_hash:z(32),transactions_root:z(32),proposals_hash:z(32),uncles_hash:z(32),dao:z(32)})}function X(t,{debugPath:e="header"}={}){const r=J(t,{debugPath:`(raw)${e}`}),n=M(e,t,{nonce:R(16)});return n.raw=r,n}function Q(t,{debugPath:e="uncle_block"}={}){return M(e,t,{header:U(X),proposals:H(z(10))})}var K=Object.freeze({__proto__:null,NormalizeScript:N,NormalizeOutPoint:L,NormalizeCellInput:V,NormalizeCellOutput:q,NormalizeCellDep:F,NormalizeRawTransaction:G,NormalizeTransaction:W,NormalizeRawHeader:J,NormalizeHeader:X,NormalizeUncleBlock:Q,NormalizeBlock:function(t,{debugPath:e="block"}={}){return M(e,t,{header:U(X),uncles:H(U(Q)),transactions:H(U(W)),proposals:H(z(10))})},NormalizeCellbaseWitness:function(t,{debugPath:e="cellbase_witness"}={}){return M(e,t,{lock:U(N),message:z(-1)})},NormalizeWitnessArgs:function(t,{debugPath:e="witness_args"}={}){const r={};return t.lock&&(r.lock=z(-1)(`${e}.lock`,t.lock)),t.input_type&&(r.input_type=z(-1)(`${e}.input_type`,t.input_type)),t.output_type&&(r.output_type=z(-1)(`${e}.output_type`,t.output_type)),r}});function Y(t,e){return e instanceof Object&&e.serializeJson instanceof Function?e.serializeJson.call(e):e}function Z(t,e,r){if(!((e=Y(0,e))instanceof Object))throw new Error(`Transformed ${t} is not an object!`);const n={};for(const[i,o]of Object.entries(r)){let r=e[i];if(!r){r=e[i.replace(/(_[a-z])/g,(t=>t.toUpperCase().replace("_","")))]}r&&(n[i]=o(`${t}.${i}`,r))}return n}function tt(t,{validation:e=!0,debugPath:r="script"}={}){return t=Z(r,t,{code_hash:Y,hash_type:Y,args:Y}),e&&f(t,{debugPath:`(transformed) ${r}`}),t}function et(t,{validation:e=!0,debugPath:r="out_point"}={}){return t=Z(r,t,{tx_hash:Y,index:Y}),e&&c(t,{debugPath:`(transformed) ${r}`}),t}function rt(t){return function(e,r){return t(r,{validation:!1,debugPath:e})}}function nt(t,{validation:e=!0,debugPath:r="cell_input"}={}){return t=Z(r,t,{since:Y,previous_output:rt(et)}),e&&h(t,{debugPath:`(transformed) ${r}`}),t}function it(t,{validation:e=!0,debugPath:r="cell_output"}={}){return t=Z(r,t,{capacity:Y,lock:rt(tt),type:rt(tt)}),e&&g(t,{debugPath:`(transformed) ${r}`}),t}function ot(t,{validation:e=!0,debugPath:r="cell_dep"}={}){return t=Z(r,t,{out_point:rt(et),dep_type:Y}),e&&d(t,{debugPath:`(transformed) ${r}`}),t}function at(t){return function(e,r){return r.map(((r,n)=>t(`${e}[${n}]`,r)))}}function ut(t,{validation:e=!0,debugPath:r="transaction"}={}){return t=Z(r,t,{version:Y,cell_deps:at(rt(ot)),header_deps:at(Y),inputs:at(rt(nt)),outputs:at(rt(it)),outputs_data:at(Y),witnesses:at(Y)}),e&&m(t,{debugPath:`(transformed) ${r}`}),t}function st(t,{validation:e=!0,debugPath:r="header"}={}){return t=Z(r,t,{version:Y,compact_target:Y,timestamp:Y,number:Y,epoch:Y,parent_hash:Y,transactions_root:Y,proposals_hash:Y,uncles_hash:Y,dao:Y,nonce:Y}),e&&k(t,{debugPath:`(transformed) ${r}`}),t}function _t(t,{validation:e=!0,debugPath:r="uncle_block"}={}){return t=Z(r,t,{header:rt(st),proposals:at(Y)}),e&&B(t,{debugPath:`(transformed) ${r}`}),t}var lt=Object.freeze({__proto__:null,TransformScript:tt,TransformOutPoint:et,TransformCellInput:nt,TransformCellOutput:it,TransformCellDep:ot,TransformRawTransaction:function(t,{validation:e=!0,debugPath:r="raw_transaction"}={}){return t=Z(r,t,{version:Y,cell_deps:at(rt(ot)),header_deps:at(Y),inputs:at(rt(nt)),outputs:at(rt(it)),outputs_data:at(Y)}),e&&b(t,{debugPath:`(transformed) ${r}`}),t},TransformTransaction:ut,TransformRawHeader:function(t,{validation:e=!0,debugPath:r="raw_header"}={}){return t=Z(r,t,{version:Y,compact_target:Y,timestamp:Y,number:Y,epoch:Y,parent_hash:Y,transactions_root:Y,proposals_hash:Y,uncles_hash:Y,dao:Y}),e&&w(t,{debugPath:`(transformed) ${r}`}),t},TransformHeader:st,TransformUncleBlock:_t,TransformBlock:function(t,{validation:e=!0,debugPath:r="block"}={}){return t=Z(r,t,{header:rt(st),uncles:at(rt(_t)),transactions:at(rt(ut)),proposals:at(Y)}),e&&P(t,{debugPath:`(transformed) ${r}`}),t},TransformCellbaseWitness:function(t,{validation:e=!0,debugPath:r="cellbase_witness"}={}){return t=Z(r,t,{lock:rt(tt),message:Y}),e&&A(t,{debugPath:`(transformed) ${r}`}),t},TransformWitnessArgs:function(t,{validation:e=!0,debugPath:r="witness_args"}={}){return t=Z(r,t,{lock:Y,input_type:Y,output_type:Y}),e&&T(t,{debugPath:`(transformed) ${r}`}),t}});var ft=Object.freeze({__proto__:null,RPCCollector:class{constructor(t,e,{skipCellWithContent:r=!0,loadData:i=!1,loadBlockNumber:o=!0}={}){this.rpc=t,this.lockHash=new n(e).serializeJson(),this.skipCellWithContent=r,this.loadData=i,this.loadBlockNumber=o}async*collect(){const t=I(await this.rpc.get_tip_block_number());let e=a.BigInt(0);for(;a.lessThanOrEqual(e,t);){let r=a.add(e,a.BigInt(100));a.greaterThan(r,t)&&(r=t);const n=await this.rpc.get_cells_by_lock_hash(this.lockHash,j(e),j(r));for(const t of n){if(this.skipCellWithContent&&(t.type||a.greaterThan(I(t.output_data_len),a.BigInt(100))))continue;let e=null;if(this.loadData){e=(await this.rpc.get_live_cell(t.out_point,!0)).cell.data.content}let r=null;if(this.loadBlockNumber){r=(await this.rpc.get_header(t.block_hash)).number}yield{cellbase:t.cellbase,cell_output:{capacity:t.capacity,lock:t.lock,type:t.type},out_point:t.out_point,block_hash:t.block_hash,data:e,output_data_len:t.output_data_len,block_number:r}}e=a.add(r,a.BigInt(1))}}}});t.BigIntToHexString=j,t.HexStringToBigInt=I,t.RPC=$,t.Reader=n,t.TransactionDumper=class{constructor(t,{validateTransaction:e=!0,depGroupUnpacker:r=null}={}){this.rpc=t,this.validateTransaction=e,this.depGroupUnpacker=r}async dumpByHash(t){const e=(await this.rpc.get_transaction(t)).transaction;return delete e.hash,await this.dump(e)}async dump(t){this.validateTransaction&&m(t);const e=[];for(const r of t.inputs){const{output:t,data:n,header:i}=await this._resolveOutPoint(r.previous_output);e.push({input:r,output:t,data:n,header:i})}const r=[];for(const e of t.cell_deps){const{output:t,data:i,header:o}=await this._resolveOutPoint(e.out_point);if(r.push({cell_dep:e,output:t,data:i,header:o}),"dep_group"===e.dep_type){if(!this.depGroupUnpacker)throw new Error("depGroupUnpacker must be provided when the transaction contains dep_group!");const t=this.depGroupUnpacker(new n(i));for(const e of t){c(e);const{output:t,data:n,header:i}=await this._resolveOutPoint(e);r.push({cell_dep:{out_point:e,dep_type:"code"},output:t,data:n,header:i})}}}const i=[];for(const e of t.header_deps)i.push(await this.rpc.get_header(e));return JSON.stringify({mock_info:{inputs:e,cell_deps:r,header_deps:i},tx:t})}async _resolveOutPoint(t){const e=await this.rpc.get_transaction(t.tx_hash);if(!e||!e.transaction)throw new Error(`Transaction ${t.tx_hash} cannot be found!`);const r=e.transaction,n=a.toNumber(a.BigInt(t.index));if(n>=r.outputs.length)throw new Error(`Transaction ${t.tx_hash} does not have output ${n}!`);const i={output:r.outputs[n],data:r.outputs_data[n]};return"committed"===e.tx_status.status&&(i.header=e.tx_status.block_hash),i}},t.VERSION="0.10.2",t.cell_collectors=ft,t.normalizers=K,t.transformers=lt,t.validators=S,Object.defineProperty(t,"__esModule",{value:!0})}));
